{
    "version": "https://jsonfeed.org/version/1",
    "title": "人生几何 • All posts by \"ctf\" tag",
    "description": "",
    "home_page_url": "https://RenshengJi.github.io",
    "items": [
        {
            "id": "https://renshengji.github.io/2023/03/05/ctf-1/",
            "url": "https://renshengji.github.io/2023/03/05/ctf-1/",
            "title": "一道ctf小题",
            "date_published": "2023-03-05T04:52:03.000Z",
            "content_html": "<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"/assets/css/APlayer.min.css\"><script src=\"/assets/js/APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><p>直接上源码：</p>\n<div class=\"highlight-container\" data-rel=\"Php\"><figure class=\"iseeu highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">highlight_file</span>(<span class=\"keyword\">__FILE__</span>);</span><br><span class=\"line\"><span class=\"title function_ invoke__\">error_reporting</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$num</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;num&#x27;</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"title function_ invoke__\">preg_match</span>(<span class=\"string\">&quot;/\\&#x27;|\\&quot;|\\`| |&lt;|&gt;|?|\\^|%|\\$/&quot;</span>, <span class=\"variable\">$num</span>)) &#123;</span><br><span class=\"line\">           <span class=\"keyword\">die</span>(<span class=\"string\">&quot;nononno&quot;</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"keyword\">eval</span>(<span class=\"string\">&quot;return $&#123;num&#125; != 2;&quot;</span>) &amp;&amp; <span class=\"variable\">$num</span> == <span class=\"number\">0</span> &amp;&amp; <span class=\"title function_ invoke__\">is_numeric</span>(<span class=\"variable\">$num</span>) != <span class=\"literal\">true</span>) &#123;</span><br><span class=\"line\"> <span class=\"title function_ invoke__\">system</span>(<span class=\"string\">&#x27;cat flag.php&#x27;</span>);</span><br><span class=\"line\">&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\"> <span class=\"keyword\">echo</span> <span class=\"string\">&#x27;2&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></div>\n<p>分析：我们需要同时满足if表达式中的三个条件</p>\n<div class=\"highlight-container\" data-rel=\"Plaintext\"><figure class=\"iseeu highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">eval(&quot;return $&#123;num&#125; != 2;&quot;) &amp;&amp; $num == 0 &amp;&amp; is_numeric($num) != true</span><br></pre></td></tr></table></figure></div>\n<ul>\n<li>第二个条件：要求get到的num弱等于0<ul>\n<li><p>弱等于比较时，会先将字符串转换为数字，其转换方式就是截取开头的数字，不过还有两种特殊情况如下：</p>\n<ul>\n<li>如果没有数字，即就是一个纯字符串的话，转化为0</li>\n<li>如果这个字符串恰好是一个科学技术法的表达式，会将此字符串按科学技术法转换为数字</li>\n</ul>\n</li>\n<li><p>示例代码如下：</p>\n  <div class=\"highlight-container\" data-rel=\"Php\"><figure class=\"iseeu highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"string\">&quot;admin&quot;</span>==<span class=\"number\">0</span>);  <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"string\">&quot;1admin&quot;</span>==<span class=\"number\">1</span>); <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"string\">&quot;2admin&quot;</span>==<span class=\"number\">2</span>); <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"string\">&quot;ad1min&quot;</span>==<span class=\"number\">1</span>); <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"string\">&quot;admin1&quot;</span>==<span class=\"number\">1</span>); <span class=\"comment\">//false</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"string\">&quot;admin1&quot;</span>==<span class=\"number\">0</span>); <span class=\"comment\">//true</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">var_dump</span>(<span class=\"number\">0e1234</span> == <span class=\"number\">0e56789</span>); <span class=\"comment\">//true </span></span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure></div></li>\n</ul>\n</li>\n<li>第三个条件：要求get到的num不是数字类型</li>\n</ul>\n",
            "tags": [
                "ctf"
            ]
        }
    ]
}